# Трейдинговая платформа

## Обзор

Модульная платформа для торговли на криптовалютных биржах с поддержкой технического анализа, индикаторов и AI-аналитики.

## Архитектура

Система построена на модульной архитектуре с четким разделением ответственности между компонентами:

1. **Ядро** (`core.js`) - центральный компонент, управляющий всей системой
2. **Модули** - отдельные функциональные блоки (индикаторы, аналитика, автотрейдинг)
3. **Коннекторы бирж** - интерфейсы для взаимодействия с различными биржами
4. **Приложение** (`app.js`) - Express-сервер, предоставляющий REST API и веб-интерфейс

## Основные компоненты

### Ядро (core.js)

Центральный компонент системы, отвечающий за:
- Управление модулями (загрузка, инициализация, выгрузка)
- Взаимодействие с биржами через коннекторы
- Систему событий для коммуникации между модулями
- Конфигурацию системы

### Коннекторы бирж

Обеспечивают унифицированный интерфейс для работы с различными биржами:

- `binance.js` - Коннектор к бирже Binance
- `bybit.js` - Коннектор к бирже Bybit
- `bitget.js` - Коннектор к бирже Bitget
- `mexc.js` - Коннектор к бирже MEXC

Все коннекторы реализуют общий интерфейс `connector-interface.js`, что обеспечивает взаимозаменяемость.

### Модули

#### Индикаторы
- `indicator-base.js` - Базовый класс для всех индикаторов
- `market-structure-shift-indicator.js` - Индикатор перелома структуры рынка
- `stop-hunt-detector-indicator.js` - Индикатор для обнаружения "охоты за стопами"
- `fair-value-gap-indicator.js` - Индикатор Fair Value Gap
- `order-block-indicator.js` - Индикатор Order Block

#### Аналитика и торговля
- `trading-analytics.js` - Модуль расширенной аналитики результатов торговли
- `auto-trader.js` - Модуль для автоматического исполнения торговых сигналов
- `adaptive-smart-grid.js` - Модуль Adaptive Smart Grid для автоматического размещения ордеров

#### AI-анализ
- `ai-analyzer.js` - Модуль AI анализа графиков
- `copy-trading-ai-integrator.js` - Интегратор копитрейдинга с AI-анализом

#### Управление
- `indicators-manager.js` - Менеджер для управления индикаторами
- `chart-manager.js` - Менеджер для управления графиком
- `copy-trading-manager.js` - Менеджер для управления копитрейдингом

## Запуск приложения

1. Установите зависимости:
   ```
   npm install
   ```

2. Создайте файл .env с настройками (см. config.js для доступных опций)

3. Запустите приложение:
   ```
   node server.js
   ```

## API

Платформа предоставляет REST API для взаимодействия с модулями:

- `/api/status` - Получение статуса сервера
- `/api/modules` - Получение списка загруженных модулей
- `/api/exchanges` - Получение списка доступных бирж
- `/api/pairs` - Получение списка доступных торговых пар
- `/api/chart` - Получение данных графика
- `/api/settings` - Получение/изменение настроек системы

Каждый модуль может регистрировать свои API эндпоинты через метод `registerApiEndpoints(app)`.

## Модульная система

Для создания нового модуля:

1. Создайте файл в директории `modules/`
2. Реализуйте класс с методами `initialize(core)`, `cleanup()` и при необходимости `registerApiEndpoints(app)`
3. Добавьте модуль в конфигурацию `config.js` в раздел `modules`

### Пример модуля:

```javascript
class MyModule {
  constructor(config) {
    this.name = 'Мой модуль';
    this.description = 'Описание модуля';
    this.config = config || {};
    this.core = null;
    this.isInitialized = false;
  }

  async initialize(core) {
    try {
      this.core = core;
      // Инициализация модуля
      this.isInitialized = true;
      return true;
    } catch (error) {
      console.error(`Ошибка инициализации модуля: ${error.message}`);
      throw error;
    }
  }

  async cleanup() {
    // Очистка ресурсов
    this.isInitialized = false;
  }

  registerApiEndpoints(app) {
    if (!app) return;
    
    // Регистрация API эндпоинтов
    app.get('/api/my-module/data', (req, res) => {
      res.json({ success: true, data: 'Hello from my module!' });
    });
  }
}

module.exports = MyModule;
```

## Система событий

Ядро предоставляет механизм событий для коммуникации между модулями:

```javascript
// Подписка на событие
core.on('event.name', (data) => {
  console.log('Получено событие:', data);
});

// Публикация события
core.emit('event.name', { message: 'Hello!' });

// Одноразовая подписка
core.once('event.name', (data) => {
  console.log('Получено одиночное событие:', data);
});

// Отписка от события
core.off('event.name', handlerFunction);
```

## Лицензия

MIT
